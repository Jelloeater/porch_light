version: '3'
vars:
    FOLDER: pl_worker
tasks:
    deploy:
        - rsync -av --delete --filter=':- .gitignore' . root@docker:/{{.FOLDER}}/
        - git secret reveal -f
        - rsync .env root@docker:/{{.FOLDER}}/.env
        - ssh root@docker 'cd /{{.FOLDER}}/; task docker:run'
        - rsync -av --delete --filter=':- .gitignore' . root@docker:/{{.FOLDER}}/
    kill: ssh root@docker 'cd /{{.FOLDER}}/; task docker:kill'
    logs: ssh root@docker 'cd /{{.FOLDER}}/; task docker:logs'
