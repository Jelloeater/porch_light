version: '3'
tasks:
    purge: docker system prune -a -f --volumes
    run:
        dotenv: [ '.env', '{{.ENV}}/.env.', '{{.HOME}}/.env' ] # Setup env vars from file for docker run
        cmds:
            - task: build
            - docker run -d --rm --name porch_light -e HUBITAT_API_APP_ID=$HUBITAT_API_APP_ID -e HUBITAT_API_TOKEN=$HUBITAT_API_TOKEN porch_light:latest
    # Docker Remote
    build: docker build . -t porch_light:latest
    attach: docker attach porch_light
    kill: docker kill porch_light
    logs: docker logs porch_light
